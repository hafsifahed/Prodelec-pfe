<div class="container">
    <h1>Liste des Utilisateurs</h1>
  
    <div class="mb-3">
      <div class="d-flex gap-2 justify-content-between align-items-center">
        <input
          type="text"
          class="form-control"
          placeholder="Rechercher par Nom, Email, ou Rôle..."
          [(ngModel)]="searchKeyword"
          (input)="onSearchInputChange()"
        />
        <button class="btn btn-secondary" (click)="clearSearch()">Effacer</button>
        <button
          class="btn btn-primary"
          (click)="navigateToAddUser()"
        >
          Ajouter un Utilisateur
        </button>
      </div>
    </div>
  
    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>
  
    <div class="table-responsive">
      <table class="table table-striped table-bordered table-hover">
        <thead class="table-light">
          <tr>
            <th>Nom</th>
            <th>Email</th>
            <th>Rôle</th>
            <th>Partenaire</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="
              let user of users | paginate: { itemsPerPage: itemsPerPage, currentPage: p }
            "
          >
            <td>{{ user.firstName }} {{ user.lastName }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.role?.name || user.role }}</td>
            <td>{{ user.partner?.name || '-' }}</td>
            <td>
              <button
                class="btn btn-sm btn-success me-1"
                (click)="editUser(user)"
                title="Modifier l'utilisateur"
              >
                Modifier
              </button>
              <button
                class="btn btn-sm btn-danger me-1"
                (click)="deleteUser(user)"
                title="Supprimer l'utilisateur"
              >
                Supprimer
              </button>
              <button
                class="btn btn-sm btn-info"
                (click)="editUserPassword(user)"
                title="Modifier le mot de passe"
              >
                Mot de Passe
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  
    <pagination-controls
      (pageChange)="p = $event"
      autoHide="true"
      maxSize="7"
      previousLabel="Précédent"
      nextLabel="Suivant"
    >
    </pagination-controls>
  
    <div *ngIf="users.length === 0 && !errorMessage" class="mt-3">
      <p>Aucun utilisateur trouvé.</p>
    </div>
  </div>
  